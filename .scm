{"latest": {"/home/user/tmp/scmpy/scm.py": ["import os, sys, json, subprocess, difflib", "", "# diff helper", "diff_lines = lambda ls_0, ls_1: \"\".join([line for line in difflib.unified_diff(ls_0, ls_1)])", "", "# Get all files that aren't hidden", "tree = [node for node in os.walk(os.getcwd()) if \".\" not in node[0]]", "fs = [os.path.join(node[0],n) for node in tree for n in node[2] if n[0] != \".\"]   ", "", "# Get or create .scm file", "if not os.path.isfile(\".scm\") or os.path.getsize(\".scm\") == 0:", "    # create", "    latest = {f:open(f).read().splitlines() for f in fs}", "    json.dump({\"latest\": latest, \"commit\":[{\"init\":latest, \"diff\":{}}]}, open(\".scm\", \"w\"))", "else:", "    # get", "    scm = json.loads(open(\".scm\",\"r\").read())", "    late = scm[\"latest\"]", "    curr = scm[\"commit\"]", "    old_fs = [f for f in curr[-1][\"init\"]] + [f for f in curr[-1][\"diff\"]]", "    new_fs = [f for f in fs if fs not in old_fs]", "    init = {f:open(f).read() for f in new_fs}", "    # We use unified diff from difflib since it still works with patch.", "    diff = {f:diff_lines(late[f],open(f).read().splitlines()) for f in old_fs}", "    scm[\"latest\"] = {f:open(f).read().splitlines() for f in fs}", "    scm[\"commit\"].append({\"init\":init,\"diff\":diff})", "    json.dump(scm, open(\".scm\",\"w\"))", "", "# Trivial Comment"]}, "commit": [{"init": {"/home/user/tmp/scmpy/scm.py": ["import os, sys, json, subprocess, difflib", "", "# diff helper", "diff_lines = lambda ls_0, ls_1: \"\".join([line for line in difflib.unified_diff(ls_0, ls_1)])", "", "# Get all files that aren't hidden", "tree = [node for node in os.walk(os.getcwd()) if \".\" not in node[0]]", "fs = [os.path.join(node[0],n) for node in tree for n in node[2] if n[0] != \".\"]   ", "", "# Get or create .scm file", "if not os.path.isfile(\".scm\") or os.path.getsize(\".scm\") == 0:", "    # create", "    print(fs)", "    latest = {f:open(f).read().splitlines() for f in fs}", "    json.dump({\"latest\": latest, \"commit\":[{\"init\":latest, \"diff\":{}}]}, open(\".scm\", \"w\"))", "else:", "    # get", "    scm = json.loads(open(\".scm\",\"r\").read())", "    late = scm[\"latest\"]", "    curr = scm[\"commit\"]", "    old_fs = [f for f in curr[-1][\"init\"]] + [f for f in curr[-1][\"diff\"]]", "    new_fs = [f for f in fs if fs not in old_fs]", "    print(old_fs)", "    print(new_fs)", "    init = {f:open(f).read() for f in new_fs}", "    # We use unified diff from difflib since it still works with patch.", "    diff = {f:diff_lines(late[f],open(f).read().splitlines()) for f in old_fs}", "    scm[\"latest\"] = {f:open(f).read().splitlines() for f in fs}", "    scm[\"commit\"].append({\"init\":init,\"diff\":diff})", "    json.dump(scm, open(\".scm\",\"w\"))"]}, "diff": {}}, {"init": {"/home/user/tmp/scmpy/scm.py": "import os, sys, json, subprocess, difflib\n\n# diff helper\ndiff_lines = lambda ls_0, ls_1: \"\".join([line for line in difflib.unified_diff(ls_0, ls_1)])\n\n# Get all files that aren't hidden\ntree = [node for node in os.walk(os.getcwd()) if \".\" not in node[0]]\nfs = [os.path.join(node[0],n) for node in tree for n in node[2] if n[0] != \".\"]   \n\n# Get or create .scm file\nif not os.path.isfile(\".scm\") or os.path.getsize(\".scm\") == 0:\n    # create\n    print(fs)\n    latest = {f:open(f).read().splitlines() for f in fs}\n    json.dump({\"latest\": latest, \"commit\":[{\"init\":latest, \"diff\":{}}]}, open(\".scm\", \"w\"))\nelse:\n    # get\n    scm = json.loads(open(\".scm\",\"r\").read())\n    late = scm[\"latest\"]\n    curr = scm[\"commit\"]\n    old_fs = [f for f in curr[-1][\"init\"]] + [f for f in curr[-1][\"diff\"]]\n    new_fs = [f for f in fs if fs not in old_fs]\n    print(old_fs)\n    print(new_fs)\n    init = {f:open(f).read() for f in new_fs}\n    # We use unified diff from difflib since it still works with patch.\n    diff = {f:diff_lines(late[f],open(f).read().splitlines()) for f in old_fs}\n    scm[\"latest\"] = {f:open(f).read().splitlines() for f in fs}\n    scm[\"commit\"].append({\"init\":init,\"diff\":diff})\n    json.dump(scm, open(\".scm\",\"w\"))\n\n# Trivial Comment\n"}, "diff": {"/home/user/tmp/scmpy/scm.py": "--- \n+++ \n@@ -28,3 +28,5 @@\n     scm[\"latest\"] = {f:open(f).read().splitlines() for f in fs}     scm[\"commit\"].append({\"init\":init,\"diff\":diff})     json.dump(scm, open(\".scm\",\"w\"))++# Trivial Comment"}}, {"init": {"/home/user/tmp/scmpy/scm.py": "import os, sys, json, subprocess, difflib\n\n# diff helper\ndiff_lines = lambda ls_0, ls_1: \"\".join([line for line in difflib.unified_diff(ls_0, ls_1)])\n\n# Get all files that aren't hidden\ntree = [node for node in os.walk(os.getcwd()) if \".\" not in node[0]]\nfs = [os.path.join(node[0],n) for node in tree for n in node[2] if n[0] != \".\"]   \n\n# Get or create .scm file\nif not os.path.isfile(\".scm\") or os.path.getsize(\".scm\") == 0:\n    # create\n    latest = {f:open(f).read().splitlines() for f in fs}\n    json.dump({\"latest\": latest, \"commit\":[{\"init\":latest, \"diff\":{}}]}, open(\".scm\", \"w\"))\nelse:\n    # get\n    scm = json.loads(open(\".scm\",\"r\").read())\n    late = scm[\"latest\"]\n    curr = scm[\"commit\"]\n    old_fs = [f for f in curr[-1][\"init\"]] + [f for f in curr[-1][\"diff\"]]\n    new_fs = [f for f in fs if fs not in old_fs]\n    init = {f:open(f).read() for f in new_fs}\n    # We use unified diff from difflib since it still works with patch.\n    diff = {f:diff_lines(late[f],open(f).read().splitlines()) for f in old_fs}\n    scm[\"latest\"] = {f:open(f).read().splitlines() for f in fs}\n    scm[\"commit\"].append({\"init\":init,\"diff\":diff})\n    json.dump(scm, open(\".scm\",\"w\"))\n\n# Trivial Comment\n"}, "diff": {"/home/user/tmp/scmpy/scm.py": "--- \n+++ \n@@ -10,7 +10,6 @@\n # Get or create .scm file if not os.path.isfile(\".scm\") or os.path.getsize(\".scm\") == 0:     # create-    print(fs)     latest = {f:open(f).read().splitlines() for f in fs}     json.dump({\"latest\": latest, \"commit\":[{\"init\":latest, \"diff\":{}}]}, open(\".scm\", \"w\")) else:@@ -20,8 +19,6 @@\n     curr = scm[\"commit\"]     old_fs = [f for f in curr[-1][\"init\"]] + [f for f in curr[-1][\"diff\"]]     new_fs = [f for f in fs if fs not in old_fs]-    print(old_fs)-    print(new_fs)     init = {f:open(f).read() for f in new_fs}     # We use unified diff from difflib since it still works with patch.     diff = {f:diff_lines(late[f],open(f).read().splitlines()) for f in old_fs}"}}]}